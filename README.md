# Лабораторная работа №4. Программирование на CUDA

## Вариант 3

Лабораторная работа состоит из двух задач:
1. Масштабирование вектора (умножение на число)
2. Пороговая фильтрация изображения (binary thresholding)

### Задача 1: Масштабирование вектора

Дан вектор `A` длиной `1 000 000` чисел с плавающей точкой. Требуется умножить каждый его элемент на заданное значение `k` (`k = 2.5`) и сохранить результат в массив `B`.

**Необходимо реализовать:**
- CPU-версию
- GPU-версию с использованием CUDA

**Алгоритм выполнения:**
- Инициализировать вектор `A` случайными числами `float`.
- Создать CPU-функцию:  
  `void scaleVectorCPU(const float* A, float* B, int N, float k);`
- Написать CUDA-ядро:  
  `__global__ void scaleVectorCUDA(const float* A, float* B, int N, float k);`
- Выделить память на GPU, скопировать данные.
- Запустить CUDA-ядро с соответствующим количеством блоков и потоков.
- Скопировать результат обратно на хост и сравнить.
- Замерить и сравнить время выполнения CPU и GPU.

### Задача 2: Пороговая фильтрация изображения

Имеется "изображение" размером `1024 × 1024`, представленное как одномерный массив `unsigned char`, значения пикселей от `0` до `255`. Требуется заменить каждый пиксель:
- Если значение больше порога `T` (`T = 128`), то сделать `255` (белый).
- Иначе — `0` (чёрный).

**Необходимо реализовать:**
- Последовательную версию (CPU)
- Параллельную версию с использованием CUDA

**Алгоритм выполнения:**
- Инициализировать входной массив случайными значениями в диапазоне `[0; 255]`.
- Создать CPU-функцию:  
  `void thresholdFilterCPU(unsigned char* input, unsigned char* output, int width, int height, unsigned char threshold);`
- Написать CUDA-ядро:  
  `__global__ void thresholdFilterCUDA(unsigned char* input, unsigned char* output, int width, int height, unsigned char threshold);`
- Настроить 2D-блоки и гриды для соответствия пикселям.
- Выделить память на GPU и скопировать данные.
- Запустить CUDA-ядро, скопировать результат на CPU.
- Сравнить результаты и замерить производительность.
